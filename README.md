[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-22041afd0340ce965d47ae6ef1cefeee28c7c493a6346c4f15d667ab976d596c.svg)](https://classroom.github.com/a/fDVzdZWF)
# Exam 1: Turtlesim + ```#``` (Multiverse Mission)


U1 | U2
:-: | :-:
[![Intro Video](./intro.webp)](intro.mp4) | [![Intro2 Video](./intro2.webp)](intro2.mp4)


<!-- <video controls src="intro.mp4" title="Title"></video> -->

เรื่องมีอยู่ว่า ในภาคก่อนหน้านี้ เต่า Killer จาก LAB1 และ LAB2 ได้ทำลายล้างดวงดาวทั้งหมดในจักรวาลที่ 1 และจักรวาลที่ 2 จนสิ้นซาก เหลือเพียง เต่า Teleop แห่งจักรวาลที่ 1 ซึ่งได้รับหน้าที่เป็น ฑูต เพียงหนึ่งเดียวที่สามารถรับสารจากพระเจ้า (USER) โดยตรง

พระเจ้ามีพระประสงค์ที่จะสร้างจักรวาลที่ 1 และจักรวาลที่ 2 ขึ้นมาใหม่ แต่เนื่องจากมีเพียงฑูตเพียงองค์เดียว จึงเป็นไปได้เพียงจักรวาลที่ 1 เท่านั้นที่จะถูกสร้างขึ้นโดยฝีมือของพระเจ้าเอง พระเจ้าจึงสถิตลงในร่างเต่า Teleop เพื่อทำการสร้าง กลุ่มดาวทั้งสี่ ขึ้นมาใหม่

เมื่อการสร้างเสร็จสิ้น เต่า Teleop ได้รับภารกิจสำคัญ นั่นคือการส่ง รูปร่างของกลุ่มดาว ทั้ง 4 ไปสู่อีกมิติ ผ่านไฟล์ .yaml เพื่อมอบให้แก่ เต่า Copy ทั้ง 4 ตัว ซึ่งเป็นเทพผู้สร้างประจำแต่ละกลุ่มดาวในจักรวาลที่ 2

เทพเต่า Copy ทั้ง 4 จึงได้สร้างกลุ่มดาวขึ้นใหม่ตามแบบแผนที่ได้รับมา และเมื่อเสร็จสิ้นแต่ละองค์จะหยุดประทับ ณ ดวงดาวดวงสุดท้ายของกลุ่มดาวที่ตนสร้าง รอคอยจนกว่าพระเจ้าจะทรงชี้จุดรวมพล เพื่อเรียกเทพทั้ง 4 มาประชุมพร้อมกันในจักรวาลที่ 2

ทว่า ขณะเหตุการณ์ดำเนินไป เทพแห่งการทำลายล้าง เฝ้าสังเกตการณ์อยู่เงียบ ๆ และฉวยจังหวะที่พระเจ้ากำลังประชุมกับเทพเต่า Copy ทั้ง 4 จึงสร้าง เต่า Eraser ขึ้นมาในจักรวาลที่ 1 ณ ตำแหน่งใดก็ได้

ทันทีที่กำเนิด เต่า Eraser เริ่มทำลายดวงดาวตามลำดับ จากดาวดวงแรกที่พระเจ้าสร้างไปจนถึงดวงสุดท้าย พร้อมทั้งไล่ล่าจนสามารถจับและสังหารเต่า Teleop ได้ เมื่อทำสำเร็จ เต่า Eraser จะเคลื่อนตัวไปยัง ประตูมิติ ซึ่งคือสถานที่เดียวกับที่พระเจ้าและเทพเต่า Copy ทั้ง 4 ประชุมกันอยู่ในจักรวาลที่ 2

เมื่อเต่า Eraser ทะลุมิติไปถึง มันจะสังหารพระเจ้าและเทพเต่าทั้ง 4 พร้อมทั้งทำลายกลุ่มดาวทั้งหมดในจักรวาลที่ 2 ตามลำดับที่พระเจ้าสร้างไว้ และเมื่อการทำลายล้างเสร็จสิ้น เต่า Eraser จะปลิดชีพตนเอง

<!-- <video controls src="intro2.mp4" title="Title"></video> -->

## Demo and Instruction Video
[![Demo Video](./demo.webp)](https://youtu.be/gRWoqEph-vQ)


## Instruction


### Objective
- เพื่อศึกษาการทำงาน ROS2 ในหัวข้อ Topics, Service, Parameter, Namespace, Launch File
- เพื่อให้นักศึกษาสามารถออกแบบสถาปัตยากรรมของโปรแกรมได้อย่างเหมาะสมและทำงานได้
- เพื่อให้นักศึกษาใช้การทำงานของ ROS2 มาเป็น Framework สำหรับการทำงานร่วมกัน

### Mission
สร้าง workspace ที่ประกอบไปด้วย Packages สำหรับภารกิจ เต่าหรรษา โดยภารกิจนี้จะประกอบไปด้วย 2 ส่วนหลักโดยแบ่งเป็นเต่า teleop และฝูงเต่า copy ซึ่งในส่วนแรก เต่า teleop มีหน้าที่ในการรับคำสั่งจาก keyboard เพื่อควบคุมการทำงานต่างๆ โดยคำสั่งที่รับมาจากคีย์บอร์ดจะมีดังนี้

 - move – รับคำสั่งจากปุ่มในแป้นพิมพ์ (เช่น asdw) เพื่อควบคุมทิศทางการเคลื่อนที่ของเต่า
 - spawn_pizza - เมื่อกดคีย์เฉพาะ โปรแกรมจะทำการวางพิซซ่าในตำแหน่งที่เต่าอยู่
 - save – เมื่อกดคีย์เฉพาะ เต่าจะ “บันทึกตำแหน่ง” ของพิซซ่าทั้งหมดที่ยังไม่ถูกบันทึกไว้ในไฟล์ .yaml
 - clear – เมื่อกดคีย์เฉพาะ เต่าจะทำการ “ไล่กิน” พิซซ่าทั้งหมดที่ยังไม่ถูกบันทึกไว้ในไฟล์ .yaml

#### ข้อบังคับของเต่า teleop
 - จำนวน pizza ที่สามารถ spawn ได้จะขึ้นจำนวน n pizza ซึ่งสามารถกำหนดค่าได้ผ่าน rqt
 - สามารถปรับค่า controller gain ได้ผ่าน rqt_service_caller
 - เมื่อมี save ครบ 4 ครั้งแล้วโปรแกรมจะไม่สามารถ save ตำแหน่งใหม่ได้อีกจนกว่าจะทำการ reset
 - เต่า teleop ต้องสามารถกำหนด namespace ได้
 - ถ้า pizza หมดก่อนที่จะวาดครบ 4 ครั้ง จะไม่สามารถ save ได้จนกว่าจะ spawn pizza ใหม่

#### ข้อบังคับของฝูงเต่า copy

ในส่วนของฝูงเต่า copy แต่ละฝูงมีหน้าที่ในการ spawn pizza ให้เหมือนกับตำแหน่งที่ save ไว้ในไฟล์ .yaml โดยฝูงเต่า copy จะเริ่มทำงานอัตโนมัติเมื่อ เต่า teleop บันทึกตำแหน่งครบ 4 ครั้ง ซึ่งขั้นตอนการทำงานของฝูงเต่า copy มีดังต่อไปนี้

 - ในการทำงานเริ่มต้น จะต้อง Spawn หุ่นยนต์เต่าทั้ง 4 ตัวจากมุมล่างซ้ายของ gui ของเต่า copy
 - หุ่นยนต์เต่าตัวที่ 1 ชื่อ Foxy มีหน้าที่วิ่งไปกึง Pizza ตามชุดตำแหน่งที่ได้จากการ save ครั้งที่ 1
 - หุ่นยนต์เต่าตัวที่ 2 ชื่อ Noetic มีหน้าที่วิ่งไปกึง Pizza ตามชุดตำแหน่งที่ได้จากการ save ครั้งที่ 2
 - หุ่นยนต์เต่าตัวที่ 3 ชื่อ Humble มีหน้าที่วิ่งไปกึง Pizza ตามชุดตำแหน่งที่ได้จากการ save ครั้งที่ 3
 - หุ่นยนต์เต่าตัวที่ 4 ชื่อ Iron มีหน้าที่วิ่งไปกึง Pizza ตามชุดตำแหน่งที่ได้จากการ save ครั้งที่ 4
 - เมื่อหุ่นยนต์เต่าแต่ละตัวทำการ spawn pizza ตามชุดตำแหน่งของตัวเองเสร็จแล้ว ให้หยุดรอจนกว่าทุกตัวจะทำงานเสร็จ จากนั้นให้หุ่นยนต์ทุกตัววิ่งไปที่ตำแหน่งที่กำหนดผ่านการ click ใน gui (ตอนที่เต่ายังกินไม่เสร็จ จะ click ไม่ได้)
 - ทันทีที่เกิดการ click ใน gui ของเต่า copy หุ่นยนต์เต่าทั้ง 4 ตัวจะวิ่งไปยังตำแหน่งที่ click และหยุดทำงาน

#### ข้อบังคับของเต่า eraser
 - เต่า eraser จะ spawn ขึ้นมาในตำแหน่งใดก็ได้ใน gui ของเต่า teleop
 - ทันทีที่เกิดการ click ใน gui ของเต่า copy  เต่า eraser จะเกิดขึ้นใน gui ของเต่า teleop จากนั้นเต่า eraser จะเริ่มไล่ล่าทำลาย pizza และเต่า teleop ตามลำดับจนหมด
 - เมื่อเต่า eraser ทำลาย pizza และเต่า teleop หมดแล้ว เต่า eraser จะวิ่งไปยังตำแหน่งประตูมิติ ซึ่งค่าของตำแหน่งจะมีค่าเท่ากับตำแหน่งที่ได้จาก click ใน gui ของเต่า copy (จากการ click ก่อนหน้านี้) แล้วทะลุมิติ ไปยัง gui ของเต่า copy แล้วทำลายเต่า copy ทั้ง 4 ตัวตามลำดับจนหมด และทำลาย pizza ตามลำดับจนหมด สุดท้ายเต่า eraser จะทำลายตัวเอง


## Requirement

1. นักศึกษาต้องสร้าง Launch สำหรับ Run node ทั้งหมด **ยกเว้น node สำหรับรับคำสั่งจากคีย์บอร์ด**
2. ถ้านักศึกษาใช้วิธีการ Hard code ในการแก้ปัญหาจะถูกหักคะแนน (ถึงแม้ใช้งานได้ก็ตาม)
3. นักศึกษาจะต้องออกแบบ System Architecture ของโปรแกรม ว่าประกอบไปด้วย package อะไรบ้างในแต่ละ package ประกอบด้วย node อะไรบ้าง ในแต่ละ node ประกอบด้วย Topic/Service อะไรบ้าง และแต่ละส่วนมีการเชื่อมโยงกันอย่างไร พร้อมเขียนอธิบายใน Document (Readme.md) โดยห้ามใช้ภาพจาก rqt_graph
4. นักศึกษาจะต้องใช้ namespace ในการจัดการ project ให้เป็นประโยชน์ ยกตัวอย่างเช่นการใช้ controller เพียง 1 node ในการควบคุมเต่า teleop และเต่า copy
5. นักศึกษาจะต้องใช้ ros parameter, service ให้เกิดประโยชน์และเหมาะสม

---

## Bonus 

- โดยปกติแล้ว เมื่อเต่าใดๆ ถูก Kill หรือถูกลบออกจากระบบ เต่าใน gui จะหายไปทันที แต่ Node Controller และ  Node Scheduler จะยังคงทำงานอยู่ ซึ่งถ้านักศึกษาสามารถทำให้ Node Controller และ  Node Scheduler หายไปได้หลังจากที่เต่าหายไป (`ros2 node list` แล้วไม่พบ) จะได้รับสิทธิ์ในการปรับคะแนนใน LAB ก่อนหน้าที่ทำไปแล้ว ได้คะแนนน้อยที่สุ จำนวน 1 LAB  เป็น 5 คะแนนเต็มทันที(ไม่ว่าจากเดิมจะได้กี่คะแนนก็ตาม)
- จากโจทย์ โจทย์บังคับอยู่แล้วว่า น้องจะต้องใช้ service ในการปรับ rqt_service_caller เพื่อปรับค่า controller gain และจำนวน pizza ที่ spawn ได้ แต่ถ้าน้องสามารถใช้ `ros2 param set` ในการแก้ไขค่าเหล่านั้นแทนได้ (ค่าต้องสามารถเปลี่ยนได้ตลอดเวลา(`Dynamic Param Set`)เหมือนกับ `service`) จะได้รับสิทธิ์ในการปรับคะแนนใน LAB ก่อนหน้าที่ทำไปแล้ว ได้คะแนนน้อยที่สุด จำนวน 1 LAB  เป็น 2.5 คะแนทันที(ไม่ว่าจากเดิมจะได้กี่คะแนนก็ตาม ถ้าได้มากกว่า 2.5 คะแนนก็จะได้คะแนนเท่าเดิม)

---

## Readme Requirement
 - อธิบายการออกแบบสถาปัตยากรรมของโปรแกรม
 - **TA สามารถทำตาม ขั้นตอนใน Readme แล้วสามารถรันโปรแกรมได้เอง**
 - ไม่ต้อง push /build /install /log /src/.vscode ขึ้น github

## Grading

| Part | Score  | 
|------|-------------|
| **Part 1: Teleop_turtle** |  
| ความถูกต้องความเสถียรของโปรแกรม | 3 |
| ความเหมาะสมในการประยุกต์ใช้ topics, service, parameter, namespace, remap | 2 |
| **Part 2: Copy_turtle** | 
| ความถูกต้องความเสถียรของโปรแกรม | 3 |
| ความเหมาะสมในการประยุกต์ใช้ topics, service, parameter, namespace, remap | 2 |
| **Part 3: Eraser_turtle** | 
| ความถูกต้องความเสถียรของโปรแกรม | 3 |
| ความเหมาะสมในการประยุกต์ใช้ topics, service, parameter, namespace, remap | 2 |
| **Part 4: System integration** |
| ความเหมาะสมและความชัดเจนของหน้าที่แต่ละ node | 2 |
| การเขียน launch file ของระบบทั้งหมด | 1.5 |
| การออกแบบสถานีโดยการรบของโปรแกรม + การเขียน doc | 1.5 |
|รวมคะแนนทั้งหมด | **20** |

### Oral Testing
- นักศึกษาจะต้องอธิบายการทำงานของโปรแกรมทั้งหมดกับ พี่ TA เพื่อนำมาเป็นคะแนนถ่วงน้ำหนัก โดยมีช่วงคะแนนดังนี้
  - อธิบายได้ถูกต้องครบถ้วน 1 คะแนนเต็ม
  - อธิบายได้ไม่ครบถ้วน 0-1 คะแนน
  - อธิบายได้ไม่ถูกต้องเลย 0 คะแนน
  - ความละเอียดของคะแนนเป็นทศนิยม 1 ตำแหน่ง เพิ่มขึ้น/ลดลง ทีละ 0.1 คะแนน

## Github Commit Score
- นักศึกษาจะต้องมีการ commit code ขึ้น github อย่างน้อย 6 ครั้ง (ไม่รวมการสร้าง repo และการส่งงานครั้งสุดท้าย) เพื่อให้พี่ TA ตรวจสอบความก้าวหน้าของงาน
- โดยให้ commit ในช่วงเวลาต่อไปนี้

| Order | Time  | 
|------|-------------|
| 1 | ศ. 12/09/2025 23:30 |
| 2 | ส. 13/09/2025 10:00 |
| 3 | ส. 13/09/2025 15:00 |
| 4 | ส. 13/09/2025 21:30 |
| 5 | อา. 14/09/2025 11:00 |
| 6 | อา. 14/09/2025 20:30 |

 - โดยในการ commit แต่ละครั้งจะต้องตั้งชื่อ commit ในรูปแบบ `Checkpoint X` โดยที่ `X` คือเลขลำดับของ commit (1-6) ถ้านักศึกษามีการ commit ไม่ครบตามจำนวน หรือ commit ไม่ตรงตามเวลาที่กำหนด หรือ commit ชื่อไม่ตรงตามรูปแบบ จะถูกหักคะแนน 1 คะแนนต่อ 1 ข้อผิดพลาด
 - โดยแต่ละ Commit จะให้เลทเวลาได้ไม่เกิน 30 นาที เช่น ถ้า commit ครั้งที่ 1 เวลา 00:00 จะได้คะแนนเต็ม แต่ถ้า commit ครั้งที่ 1 เวลา 00:31 จะถูกหัก 1 คะแนน
 - การ commit นอกเหนือจากที่กำหนดจะไม่นำมาคิดคะแนน
 - คะแนนเต็ม 1 คะแนน 
 - commit ถูกต้องครบถ้วน 1 คะแนนเต็ม
 - commit ไม่ครบถ้วน 0-1 คะแนน ถัวเฉลี่ยตามจำนวน commit ที่ถูกต้อง
 - commit ไม่ถูกต้องเลย 0 คะแนน


### Total Score
- คะแนนเต็ม 20 คะแนน คูณด้วย คะแนน Oral Testing และ คะแนน Github Commit จะเป็นคะแนนรวมสุดท้ายของนักศึกษา

## Rule
1. นักศึกษาต้องจับกลุ่มกันทำงานเป็นทีม ทีมละไม่เกิน 2 คน (1 คนก็ได้)
2. นักศึกษาต้องส่งงานผ่านทาง GitHub Classroom เท่านั้น
3. นักศึกษาต้องส่งงานภายในวันที่ 14 กันยายน 2568 เวลา 23.30 น.